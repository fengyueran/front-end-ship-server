---
title: 插入排序算法排序
tags: [JS]
type: SHORT_ANSWER
date: 2018-1-15 18:10:20
---

### 插入排序算法

插入排序的代码实现虽然没有冒泡排序和选择排序那么简单粗暴，但它的原理应该是最容易理解的了，因为只要打过扑克牌的人都应该能够秒懂。插入排序是一种最简单直观的排序算法，它的工作原理是通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。

插入排序和冒泡排序一样，也有一种优化算法，叫做拆半插入。

- 算法描述

一般来说，插入排序都采用 in-place 在数组上实现。

- 从第一个元素开始，该元素可以认为已经排好序
- 取出下一个元素，在已经排序的元素序列中，从后向前开始扫描
- 如果该元素(已排序的元素)大于新元素，则将该元素向后移动
- 重复步骤 3，直到找到已排序元素小于等于新元素的位置
- 将新元素插入到该位置
- 重复步骤 2-5

```js
var insertionSort = (arr) => {
  let preIndex;
  let current;
  const n = arr.length;
  for (let i = 1; i < n; i++) {
    preIndex = i - 1;
    current = arr[i];
    while (preIndex >= 0 && arr[preIndex] > current) {
      arr[preIndex + 1] = arr[preIndex];
      preIndex--;
    }
    arr[preIndex + 1] = current;
  }
  return arr;
};
```

数组`[8,5,3,7,1]`用插入排序法过程如下：

```
8 5 3 7 1
5 8 3 7 1
3 5 8 7 1
3 5 7 8 1
1 3 5 7 8
```

![](http://blog-bed.oss-cn-beijing.aliyuncs.com/66.%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/insert-sort.gif)

- 时间复杂度计算

如果目标是升序排列一个数组，那么存在最好和最坏的情况。最好的情况：如果数组已经是按升序排列，则只需要进行 n-1 次比较操作；最坏的情况：数组是按降序排列

```
如果数组是降序排列：
当i=1时，运行次数T(1)= 1;
当i=2时，运行次数T(2)= 2;
当i=3时，运行次数T(3)= 3;
...
当i=n-1时，运行次数T(n-1)= n - 1;
因此总的运行次数T(n) = 1 + 2 + 3 + ... + (n-2) + (n-1)
                  =  0.5 * (n^2 - n)
                  = O(n^2)

```

平均来说插入排序算法复杂度为 **O(n^2)**，为**稳定算法**。

- 空间复杂度

由于该算法额外开辟的空间只有几个变量，因此其**空间复杂度为 O(1)**。
