---
title: è®¾è®¡æ¨¡å¼
tags: [Http]
type: SHORT_ANSWER
date: 2022-12-15 18:10:20
---

### è®¾è®¡åŸºæœ¬åŸåˆ™

- å¯¹äºå¯é¢„è§çš„ä¼šå˜åŒ–çš„é‚£éƒ¨åˆ†ä»£ç æŠ½ç¦»å‡ºæ¥ï¼Œå’Œå…¶ä»–ç¨³å®šçš„ä»£ç æœ‰æ‰€åŒºåˆ«
- é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¸é’ˆå¯¹å®ç°ç¼–ç¨‹
- å¼€é—­åŸåˆ™
- ä¾èµ–å€’ç½®åŸåˆ™

### ç­–ç•¥æ¨¡å¼

ç­–ç•¥æ¨¡å¼(Strategy Pattern)å®šä¹‰äº†ä¸€ç³»åˆ—çš„ç®—æ³•ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œæ­¤æ¨¡å¼çš„é‡ç‚¹ä¸åœ¨äºå¦‚ä½•å®ç°ç®—æ³•ï¼Œè€Œæ˜¯å¦‚ä½•ç»„ç»‡ï¼Œè°ƒç”¨ç®—æ³•ï¼Œè®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚

æ¯”å¦‚ï¼Œè¦å®ç°ä¸‰ç§ç™»å½•æ–¹å¼ï¼Œè´¦å·å¯†ç ç™»å½•ã€æ‰‹æœºéªŒè¯ç ç™»å½•ï¼Œå¾®ä¿¡æ‰«ç ç™»å½•ï¼Œè¿™ç›¸å½“äºæœ‰ä¸‰ç§ç­–ç•¥(ç®—æ³•)å»å®ç°ç™»å½•ã€‚

```ts
interface Strategy {
  login(...args: any): any;
}

class Authenticator {
  strategy?: Strategy;

  setStrategy(strategy: Strategy) {
    this.strategy = strategy;
  }

  login(...args: any) {
    if (!this.strategy) {
      throw new Error('There is no strategy');
    }
    return this.strategy.login(...args);
  }
}

class AccountStrategy implements Strategy {
  login(username: string, password: string) {
    if (username === 'xinghunm@keyayun.com' && password === '123456') {
      return 'success';
    }
    throw new Error('user or password error');
  }
}

class SMSStrategy implements Strategy {
  login(authcode: string) {
    if (authcode === '123') {
      return 'success';
    }
    throw new Error('authcode error');
  }
}

class WechatStrategy implements Strategy {
  login(wechatToken: string) {
    if (wechatToken === '456') {
      return 'success';
    }
    throw new Error('wechatToken error');
  }
}

const auth = new Authenticator();

auth.setStrategy(new AccountStrategy());
auth.login('xinghunm@keyayun.com', '123456');

auth.setStrategy(new SMSStrategy());
auth.login('147985');

auth.setStrategy(new WechatStrategy());
auth.login('j6HG43');
```

ä¹Ÿå¯ä»¥æ˜¯ map è¿™ç§ç®€å•çš„å½¢å¼:

```ts
enum Level {
  S1,
  S2,
  S3,
}
const strategyMap = {
  [Level.S1]: (salary: number) => {
    return salary * 12;
  },
  [Level.S2]: (salary: number) => {
    return salary * 8;
  },
  [Level.S3]: (salary: number) => {
    return salary * 4;
  },
};

const calculateBonus = (strategy: Level, salary: number) => {
  return strategyMap[strategy](salary);
};
```

### è§‚å¯Ÿè€…æ¨¡å¼

è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡é—´çš„ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œå½“ä¸»é¢˜å¯¹è±¡(Subject)å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå®ƒæ‰€æœ‰çš„è§‚å¯Ÿè€…(Observer)éƒ½ä¼šå¾—åˆ°é€šçŸ¥ï¼Œä»è€Œå¯ä»¥åšè¿›ä¸€æ­¥çš„å¤„ç†ã€‚

å‡å¦‚åŠ¨ç‰©å›­æœ‰å° ğŸ¶ã€å° ğŸ·ï¼Œå° ğŸ˜» ä¸‰ä¸ªåŠ¨ç‰©ï¼Œå®ƒä»¬éƒ½è§‚å¯Ÿç€é¥²å…»å‘˜ï¼Œé¥²å…»å‘˜æœ‰å¥½åƒçš„å°±æ‹›å‘¼å®ƒä»¬:

```ts
interface Observer {
  update(...args: unknown[]): void;
}

class Subject {
  private observers: Observer[] = [];

  registerObserver = (o: Observer) => {
    this.observers.push(o);
  };

  removeObserver = (o: Observer) => {
    const index = this.observers.indexOf(o);
    if (index >= 0) {
      this.observers.splice(index, 1);
    }
  };

  notifyObservers = (...args: unknown[]) => {
    this.observers.forEach((o) => {
      o.update(...args);
    });
  };
}

class Breeder extends Subject {
  private meat?: string;
  private fruit?: string;

  private foodsChanged = () => {
    this.notifyObservers(this.meat, this.fruit);
  };

  setFoods = (meat: string, fruit: string) => {
    this.meat = meat;
    this.fruit = fruit;
    this.foodsChanged();
  };
}

class Animal implements Observer {
  constructor(private name: string) {
    this.name = name;
  }

  update = (meat: string, fruit: string) => {
    console.log(`${this.name} meat:`, meat);
    console.log(`${this.name} fruit:`, fruit);
  };
}

const subject = new Breeder();
const dogObserver = new Animal('dog');
const pigObserver = new Animal('pig');
const catObserver = new Animal('cat');
subject.registerObserver(dogObserver);
subject.registerObserver(pigObserver);
subject.registerObserver(catObserver);
subject.setFoods('fish', 'apple');

subject.removeObserver(pigObserver);
subject.setFoods('pork', 'banana');
```

#### è§‚å¯Ÿè€…æ¨¡å¼è¦ç‚¹

- ä¸€(é¥²å…»å‘˜)å¯¹å¤š(å„ç§åŠ¨ç‰©)çš„å…³ç³»
- Subject ç”¨ä¸€ä¸ªå…±åŒçš„æ¥å£(update)æ¥é€šçŸ¥ Observer
- Subject å’Œ Observer é—´æ˜¯æ¾æ•£è€¦åˆï¼ŒSubject ä¸çŸ¥é“ Observer çš„ç»†èŠ‚ï¼ŒåªçŸ¥é“ Observer å®ç°äº† update æ¥å£
- Observer è·å–çš„æ•°æ®é€šå¸¸æ˜¯ Subject ä¸»åŠ¨æ¨é€è¿‡æ¥çš„(æ¨æ¨¡å¼)ï¼Œä¹Ÿå¯ä»¥ä¸»åŠ¨å‘ Subject ç´¢å–(æ¯”å¦‚è½®è¯¢)
- æœ‰å¤šä¸ª Observer æ—¶ä¸åº”è¯¥ä¾èµ–ç‰¹å®šçš„é€šçŸ¥é¡ºåº

### è£…é¥°è€…æ¨¡å¼

è£…é¥°å™¨æ¨¡å¼ç±»ä¼¼äºé«˜é˜¶ç»„ä»¶ï¼Œèƒ½å¤ŸåŠ¨æ€çš„åŠ å…¥ä¸€äº›æ–°ç‰¹æ€§ï¼Œæ¯”ç»§æ‰¿æ›´å…·å¼¹æ€§ã€‚

æ¯”å¦‚ä¸€ä¸ªå¥¶èŒ¶åº—æœ‰å¤šç§å¥¶èŒ¶ï¼Œå¥¶èŒ¶å¯ä»¥åŠ ä¸åŒçš„è°ƒæ–™ï¼Œè¦å®ç°ç‚¹å•è®¡ç®—å‡ºä»·æ ¼å’Œæè¿°çš„åŠŸèƒ½:

```ts
interface MilkyTea {
  cost: () => number;
  getDescription: () => string;
}
/******************å¥¶èŒ¶********************/
//èŠ’æœå¥¶èŒ¶
class MangoMilkTea implements MilkyTea {
  cost = () => 16;
  getDescription = () => 'MangoMilkTea';
}
//è‘¡è„å¥¶èŒ¶
class GrapeMilkTea implements MilkyTea {
  cost = () => 20;
  getDescription = () => 'GrapeMilkTea';
}

/******************å¸¦è°ƒæ–™çš„å¥¶èŒ¶********************/
//èŠå£«
class MilkyTeaWithCheese implements MilkyTea {
  constructor(private milkTea: MilkyTea) {
    this.milkTea = milkTea;
  }
  cost = () => this.milkTea.cost() + 2;
  getDescription = () => this.milkTea.getDescription() + ', Cheese';
}
//çç 
class MilkyTeaWithPearl implements MilkyTea {
  constructor(private milkTea: MilkyTea) {
    this.milkTea = milkTea;
  }
  cost = () => this.milkTea.cost() + 3;
  getDescription = () => this.milkTea.getDescription() + ', Pearl';
}
//èŠ‹åœ†
class MilkyTeaWithTaroBall implements MilkyTea {
  constructor(private milkTea: MilkyTea) {
    this.milkTea = milkTea;
  }
  cost = () => this.milkTea.cost() + 4;
  getDescription = () => this.milkTea.getDescription() + ', TaroBall';
}

//è€æ¿ï¼Œä¸€æ¯èŠ’æœå¥¶èŒ¶ï¼ŒåŠ èŠå£«
let mangoMilkTea = new MangoMilkTea();
mangoMilkTea = new MilkyTeaWithCheese(mangoMilkTea);
console.log(
  'mangoMilkTea:',
  mangoMilkTea.getDescription() + ', $' + mangoMilkTea.cost()
); //mangoMilkTea: MangoMilkTea, Cheese, $18

//ä¸€æ¯è‘¡è„å¥¶èŒ¶ï¼ŒåŠ èŠå£«ã€çç ã€èŠ‹åœ†
let grapeMilkTea = new GrapeMilkTea();
grapeMilkTea = new MilkyTeaWithCheese(grapeMilkTea);
grapeMilkTea = new MilkyTeaWithPearl(grapeMilkTea);
grapeMilkTea = new MilkyTeaWithTaroBall(grapeMilkTea);
console.log(
  'grapeMilkTea:',
  grapeMilkTea.getDescription() + ', $' + grapeMilkTea.cost()
); //grapeMilkTea: GrapeMilkTea, Cheese, Pearl, TaroBall, $29
```

#### è¦ç‚¹

- ç›¸æ¯”äºç»§æ‰¿è£…é¥°æ›´å…·å¼¹æ€§(ä¼˜ç‚¹)

  è£…é¥°è€…æ¨¡å¼åŒç»§æ‰¿ä¸€æ ·éƒ½å¯ä»¥ç”¨æ¥æ‰©å±•è¡Œä¸ºï¼Œä½†è£…é¥°æ›´å…·å¼¹æ€§ï¼Œå› ä¸ºç»§æ‰¿çš„çˆ¶ç±»å¯èƒ½å®ç°äº†å­ç±»æ ¹æœ¬ä¸éœ€è¦çš„ä¸œè¥¿ï¼Œå¦‚ä¸‹ï¼Œ dog æ ¹æœ¬ä¸ä¼š fly:

  ```ts
  class Animal {
    fly = () => {
      console.log('I can fly');
    };
  }

  class dog extends Animal {
    bite = () => {};
  }
  ```

- è£…é¥°è€…æ˜¯ç¬¦åˆå¼€é—­åŸåˆ™çš„(ä¼˜ç‚¹)

  å‡å¦‚ç°åœ¨å¥¶èŒ¶è¦åŠ å†°å—ï¼Œä¸éœ€è¦æ”¹åŠ¨åŸæ¥çš„ä»£ç :

  ```ts
  //å†°å—
  class MilkyTeaWithIce implements MilkyTea {
    constructor(private milkTea: MilkyTea) {
      this.milkTea = milkTea;
    }
    cost = () => this.milkTea.cost() + 0.5;
    getDescription = () => this.milkTea.getDescription() + ', Ice';
  }

  let mangoMilkTea = new MangoMilkTea();
  mangoMilkTea = new MilkyTeaWithCheese(mangoMilkTea);
  mangoMilkTea = new MilkyTeaWithIce(mangoMilkTea);
  console.log(
    'mangoMilkTea:',
    mangoMilkTea.getDescription() + ', $' + mangoMilkTea.cost()
  ); //mangoMilkTea: MangoMilkTea, Cheese, Ice, $18.5
  ```

- ä¸åº”é’ˆå¯¹å…·ä½“çš„ç»„ä»¶è¿›è¡Œç‰¹å®šä»»åŠ¡

  æ¯”å¦‚ MangoMilkTeaï¼Œä¸ä»…å®ç°äº†æ¥å£ MilkyTeaï¼Œè¿˜è‡ªå·±åŠ äº†ä¸€ä¸ªæ‰“æŠ˜ discountï¼Œè¿™å°±ä¼šå¯¼è‡´è£…é¥°è€…åŒ…è£…åç±»å‹çš„æ”¹å˜:

  ```ts
  //èŠ’æœå¥¶èŒ¶
  class MangoMilkTea implements MilkyTea {
    cost = () => 16;
    getDescription = () => 'MangoMilkTea';
    discount = () => 0.8;
  }

  let mangoMilkTea = new MangoMilkTea();
  //error: Property 'discount' is missing in type 'MilkyTeaWithCheese' but required in type 'MangoMilkTea'.
  mangoMilkTea = new MilkyTeaWithCheese(mangoMilkTea);
  ```

  è¿™ç§æƒ…å†µå¯èƒ½éœ€è¦é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¿®æ”¹æ¥å£ MilkyTea æˆ–è€…é‡æ–°æ€è€ƒè£…é¥°è€…æ˜¯å¦åˆé€‚ã€‚

- è£…é¥°è€…ç±»åæ˜ å‡ºè¢«è£…é¥°çš„ç»„ä»¶ç±»å‹

  äº‹å®ä¸Šå®ƒä»¬å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼Œéƒ½ç»è¿‡æ¥å£(MilkyTea)æˆ–ç»§æ‰¿å®ç°ã€‚è¿™ä¹Ÿæ˜¯è£…é¥°è€…èƒ½å¤Ÿå¯¹ç”¨æˆ·é€æ˜çš„æ ¹æœ¬ã€‚

  ```ts
  let mangoMilkTea = new MangoMilkTea(); //MangoMilkTeaç±»å‹
  mangoMilkTea = new MilkyTeaWithCheese(mangoMilkTea); //MangoMilkTeaç±»å‹

  let grapeMilkTea = new GrapeMilkTea(); //GrapeMilkTeaç±»å‹
  grapeMilkTea = new MilkyTeaWithCheese(grapeMilkTea); //GrapeMilkTeaç±»å‹
  ```

- è£…é¥°è€…å¯¹ç»„ä»¶çš„ç”¨æˆ·æ˜¯é€æ˜çš„

  å½“å®¢æˆ·ä½¿ç”¨ç»„ä»¶æ—¶ï¼Œè£…æ²¡è£…é¥°è¿‡å®¢æˆ·æ˜¯ä¸æ¸…æ¥šçš„ï¼Œå› ä¸ºç»„ä»¶å’Œè¢«è£…é¥°åçš„ç»„ä»¶éƒ½æ˜¯ä¸€ä¸ªç±»å‹ã€‚å¦‚ä¸‹:
  å½“æŠŠè¢«è£…é¥°åçš„ decoratedMangoMilkTea å¯¼å‡ºä½¿ç”¨æ—¶ï¼Œç”¨æˆ·å¹¶ä¸ä¼šè§‰å¾—(è£…é¥°å‰å)æœ‰ä»€ä¹ˆä¸åŒï¼Œä¹Ÿå°±ä¸ä¼šå¯Ÿè§‰æ˜¯å¦è¢«è£…é¥°è¿‡äº†ã€‚

  ```ts
  const mangoMilkTea = new MangoMilkTea();
  const decoratedMangoMilkTea = new MilkyTeaWithCheese(mangoMilkTea);
  ```

- è£…é¥°è€…ä¸åº”è¯¥çŸ¥é“é“¾æ¡å†…çš„å…¶ä»–è£…é¥°è€…

  è£…é¥°è€…åªæ˜¯æ·»åŠ æ–°çš„è¡Œä¸ºåˆ°åŒ…è£…å¯¹è±¡ä¸Šï¼Œå¯¹äºçª¥æ¢å…¶ä»–è£…é¥°è€…è¶…å‡ºäº†å®ƒçš„å¤©èµ‹ã€‚

- è£…é¥°è€…å¯èƒ½å¯¼è‡´è¿‡å¤šçš„å°å¯¹è±¡(ç¼ºç‚¹)

  å‡å¦‚è¦åŠ çš„è°ƒæ–™æœ‰ 80 ç§ï¼Œå¯èƒ½éœ€è¦ç®¡ç† 80 ä¸ªå¯¹è±¡ï¼Œé€ æˆäº†ä¸€å®šçš„å¤æ‚åº¦ã€‚

### å·¥å‚æ¨¡å¼

æ‰€æœ‰çš„å·¥å‚æ¨¡å¼éƒ½æ˜¯ç”¨æ¥å°è£…å¯¹è±¡çš„åˆ›å»ºã€‚

#### ç®€å•å·¥å‚

ç®€å•å·¥å‚å°±æ˜¯å®šä¹‰ä¸€ä¸ªå·¥å‚ç±»ï¼Œæ ¹æ®ä¼ å…¥çš„å‚æ•°ä¸åŒè¿”å›ä¸åŒçš„å®ä¾‹(äº§å“ç±»å®ä¾‹)ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹å…·æœ‰å…±åŒçš„çˆ¶ç±»æˆ–æ¥å£ã€‚

ç®€å•å·¥å‚é€šå¸¸ç”¨ä¸€ä¸ªé™æ€æ–¹æ³•(æ— éœ€è¦å®ä¾‹åŒ–å·¥å‚)æ¥åˆ›å»ºå¯¹è±¡ï¼Œå› æ­¤ç®€å•å·¥å‚ä¹Ÿå«é™æ€å·¥å‚ï¼Œä½†æ˜¯é™æ€æ–¹æ³•ä¸èƒ½é€šè¿‡ç»§æ‰¿æ”¹å†™ã€‚

```ts
abstract class Iphone {
  abstract play(): void;
}

class Iphone13 extends Iphone {
  play(): void {
    console.log('Play Iphone13');
  }
}

class Iphone14 extends Iphone {
  play(): void {
    console.log('Play Iphone14');
  }
}

enum IphoneType {
  Iphone13,
  Iphone14,
}

class IphoneFactory {
  static produceIphone(type: IphoneType) {
    if (type === IphoneType.Iphone13) {
      return new Iphone13();
    } else {
      return new Iphone14();
    }
  }
}

/******************å®¢æˆ·ç¨‹åºä»£ç ******************/
let iphone = IphoneFactory.produceIphone(IphoneType.Iphone13);
iphone.play(); //Play Iphone13

iphone = IphoneFactory.produceIphone(IphoneType.Iphone14);
iphone.play(); //Play Iphone14
```

æ¥é‡å¤ä¸€ä¸‹å®šä¹‰ï¼Œç®€å•å·¥å‚å°±æ˜¯å®šä¹‰ä¸€ä¸ªå·¥å‚ç±»(IphoneFactory)ï¼Œæ ¹æ®ä¼ å…¥çš„å‚æ•°(type)ä¸åŒè¿”å›ä¸åŒçš„å®ä¾‹(iphone)ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹(iphone)å…·æœ‰å…±åŒçš„çˆ¶ç±»æˆ–æ¥å£(play)ã€‚

ç®€å•å·¥å‚é€‚åˆä¸éœ€è¦å…³å¿ƒäº§å“ç±»çš„å¯¹è±¡çš„å…·ä½“åˆ›å»ºè¿‡ç¨‹ä»¥åŠäº§å“ç±»å¯¹è±¡è¾ƒå°‘çš„åœºæ™¯ã€‚

#### å·¥å‚æ–¹æ³•

å·¥å‚æ–¹æ³•æ˜¯ç®€å•å·¥å‚çš„è¿›ä¸€æ­¥æ·±åŒ–ï¼Œåœ¨å·¥å‚æ–¹æ³•ä¸­ä¸å†æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å·¥å‚ç±»æ¥åˆ›å»ºæ‰€æœ‰äº§å“å¯¹è±¡ï¼Œè€Œæ˜¯é’ˆå¯¹ä¸åŒçš„äº§å“å¯¹è±¡æä¾›ä¸åŒçš„å·¥å‚æ¥åˆ›å»ºã€‚

å·¥å‚æ–¹æ³•æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ª**åˆ›å»ºå¯¹è±¡**çš„æ¥å£å¹¶ç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–çš„ç±»æ˜¯å“ªä¸€ä¸ªã€‚å·¥å‚æ–¹æ³•è®©ç±»(äº§å“ç±»)æŠŠå®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚

ä¸‹ä¾‹ä¸­ IphoneFactory å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ produceIphoneï¼Œè¿™ä¸ªæ¥å£ä¹Ÿç§°ä¸ºå·¥å‚æ–¹æ³•(å·¥å‚æ–¹æ³•æ¨¡å¼çš„ç”±æ¥)ã€‚åœ¨ IphoneFactory ä¸­ï¼Œä»»ä½•å…¶ä»–æ–¹æ³•(orderIphone)éƒ½å¯èƒ½ä½¿ç”¨åˆ°è¿™ä¸ªå·¥å‚æ–¹æ³•(produceIphone)åˆ›å»ºå‡ºæ¥çš„äº§å“(iphone)ï¼Œä½†åªæœ‰å­ç±»(Iphone13Factoryï¼Œ Iphone14Factory)çœŸæ­£å®ç°è¿™ä¸ªå·¥å‚æ–¹æ³•å¹¶åˆ›å»ºäº§å“(Iphone)ã€‚è¿™å°±å®ç°äº†è¶…ç±»(IphoneFactory)çš„ä»£ç å’Œå­ç±»(Iphone13Factoryï¼ŒIphone14Factory)å¯¹è±¡åˆ›å»ºä»£ç è§£è€¦äº†ï¼Œ

```ts
abstract class Iphone {
  abstract play(): void;
  abstract package(): void;
}

class Iphone13 extends Iphone {
  play = () => {
    console.log('Play Iphone13');
  };

  package = () => {
    console.log('Package Iphone13');
  };
}

class Iphone14 extends Iphone {
  play = () => {
    console.log('Play Iphone14');
  };
  package = () => {
    console.log('Package Iphone14');
  };
}

enum IphoneType {
  Iphone13,
  Iphone14,
}

abstract class IphoneFactory {
  abstract produceIphone(): Iphone;
  orderIphone = () => {
    const iphone = this.produceIphone();
    iphone.package();
    return iphone;
  };
}

class Iphone13Factory extends IphoneFactory {
  produceIphone() {
    return new Iphone13();
  }
}

class Iphone14Factory extends IphoneFactory {
  produceIphone() {
    return new Iphone14();
  }
}

const iphone13Factory = new Iphone13Factory();
const iphone13 = iphone13Factory.orderIphone();
iphone13.play(); //Play Iphone13

const iphone14Factory = new Iphone14Factory();
const iphone14 = iphone14Factory.orderIphone();
iphone14.play(); //Play Iphone14
```

#### æŠ½è±¡å·¥å‚

æŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory Pattern)ï¼Œæ˜¯å·¥å‚æ–¹æ³•çš„è¿›ä¸€æ­¥æ·±åŒ–ï¼Œå®ƒæä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— é¡»æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚

å¦‚ä¸‹: IphoneFactory ä¸ºä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ²¡æœ‰æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»(Iphone):

```ts
interface IphoneFactory {
  produceIphone13();
  produceIphone14();
}

class ConcreteIphoneFactory implements IphoneFactory {
  produceIphone13() {
    return new Iphone13();
  }
  produceIphone14() {
    return new Iphone14();
  }
}

const iphoneFactory = new ConcreteIphoneFactory();
const iphone13 = iphoneFactory.produceIphone13();
iphone13.play();

const iphone14 = iphoneFactory.produceIphone14();
iphone14.play();
```

#### è¦ç‚¹

- æ‰€æœ‰å·¥å‚éƒ½æ˜¯ç”¨æ¥å°è£…å¯¹è±¡çš„åˆ›å»º

- æ‰€æœ‰å·¥å‚æ¨¡å¼éƒ½æ˜¯é€šè¿‡å‡å°‘åº”ç”¨ç¨‹åºä¸å…·ä½“ç±»é—´çš„ä¾èµ–ä¿ƒè¿›æ¾è€¦åˆ

- ç®€å•å·¥å‚ä¸æ˜¯çœŸæ­£çš„è®¾è®¡æ¨¡å¼

  æ˜¯ä¸€ç§ç®€å•æ–¹æ³•ï¼Œå°†å®¢æˆ·ç¨‹åºä¸å…·ä½“ç±»è§£è€¦ã€‚

- å·¥å‚æ–¹æ³•ç¬¦åˆä¾èµ–å€’ç½®çš„åŸåˆ™

- æŠ½è±¡å·¥å‚ä¸ç¬¦åˆå¼€é—­åŸåˆ™

  å½“å·¥å‚éœ€è¦æ”¹å˜äº§å“æ—¶ä¸å¾—ä¸æ”¹å˜åŸæ¥çš„æ¥å£ï¼Œæ¯”å¦‚æ·»åŠ ä¸€ä¸ª produceIphone15 çš„æ–¹æ³•:

  ```ts
  interface IphoneFactory {
    produceIphone13();
    produceIphone14();
    produceIphone15();
  }
  ```

### å•ä¾‹æ¨¡å¼

å•ä¾‹æ¨¡å¼(Singleton Pattern)ï¼Œç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€æ–¹æ³•è®¿é—®å®ƒã€‚

æœ‰äº›å¯¹è±¡å…¶å®æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªï¼Œæ¯”å¦‚çº¿ç¨‹æ± ã€ç¼“å­˜ç­‰ï¼Œå¤šä¸ªå¯¹è±¡åè€Œä¼šå¸¦æ¥é—®é¢˜ã€‚

```ts
class Singleton {
  private static uniqueInstance: Singleton;

  private constructor() {}
  static getInstance() {
    if (!Singleton.uniqueInstance) {
      Singleton.uniqueInstance = new Singleton();
    }
    return Singleton.uniqueInstance;
  }

  someMethod() {}
}

//error: Constructor of class 'Singleton' is private and only accessible within the class declaration.
const s = new Singleton();

const instance = Singleton.getInstance();

instance.someMethod();
```

#### è¦ç‚¹

- åªæœ‰ä¸€ä¸ªå®ä¾‹èƒ½å¤Ÿå¯ä»¥èŠ‚çº¦å†…å­˜

  å¯¹äºä¸€äº›é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡å•ä¾‹æ¨¡å¼æ— æ„å¯ä»¥æä¾›ç³»ç»Ÿçš„æ€§èƒ½ï¼Œ

- æ²¡æœ‰æŠ½è±¡å±‚æ‰©å±•è¾ƒå›°éš¾

- å•ä¾‹ç±»ï¼ŒèŒè´£è¿‡é‡ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿èƒŒäº†å•ä¸€èŒè´£

### å‘½ä»¤æ¨¡å¼

å°†è¯·æ±‚å°è£…æˆå¯¹è±¡ï¼Œä»¥ä¾¿ä½¿ç”¨ä¸åŒçš„è¯·æ±‚ã€é˜Ÿåˆ—ã€æˆ–è€…æ—¥å¿—æ¥å‚æ•°åŒ–å…¶ä»–å¯¹è±¡ã€‚å‘½ä»¤æ¨¡å¼æ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚
